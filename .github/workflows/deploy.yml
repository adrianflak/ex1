on: 
    push:
        branches:
            - main
            - production
    workflow_dispatch:

jobs: 
    build: 
        runs-on: ubuntu-latest
    
        steps:
           - uses: actions/checkout@v5

           - name: Node.js action 
             uses: actions/setup-node@v4
             with: 
                node-version: '18.x'

           - name: Install npm
             run: |
                npm install
                npm test 
    deploy:
         runs-on: ubuntu-latest
         needs: build
    
         steps:
          - name: Sync files
            uses: SamKirkland/FTP-Deploy-Action@v4.3.6
            with:
                protocol: sftp
                port: 22
                server: ${{ secrets.ftp_hostname }}
                username: ${{ secrets.ftp_username }}
                password: ${{ secrets.ftp_password }} 
        

        